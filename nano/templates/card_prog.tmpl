{{if data.printing}}
	<h5 class='average'>Компьютер в текущий момент занят.</h5>
	<div class='notice'>
		<center>Печать...</center>
	</div>
	<p>
		Спасибо за Ваше терпение!
	</p>
{{else}}
	{{:helper.link('Модификация доступа', 'home', {'action' : 'PRG_mode', 'mode_target' : 0}, !data.mode ? 'disabled' : null)}}
	{{:helper.link('Управление занятостью', 'gear', {'action' : 'PRG_mode', 'mode_target' : 1}, data.mode == 1 ? 'disabled' : null)}}
	{{:helper.link('Манифест экипажа', 'folder-open', {'action' : 'PRG_mode', 'mode_target' : 2}, data.mode == 2 ? 'disabled' : null)}}
	{{:helper.link('Печать', 'print', {'action' : 'PRG_print'}, data.printer && (data.mode == 2 || data.has_modify && !data.mode) ? null : 'disabled')}}
	{{:helper.link('Записи', 'file', {'action' : 'PRG_mode', 'mode_target' : 3}, (data.mode == 3) ? 'disabled' : null)}}

	{{if data.mode == 1}}
	<div class='item'>
		<h2>Управление занятостью</h2>
	</div>
    <div class='item'>
		<div class='itemLabel'>
			Авторизованная личность:
		</div>
		<div class='itemContent'>
			{{:helper.link(data.scan_name, 'eject', {'action' : 'PRG_scan'})}}
		</div>
		<div class='itemLabel'>
			Откат:
		</div>
		<div class='itemContent'>
			{{if data.cooldown_mins > 0 || data.cooldown_mins == 0 && data.cooldown_secs > 0}}
				<span class='bad'>Следующее изменение через: {{:data.cooldown_mins}}:{{:data.cooldown_secs}}</span>
			{{else}}
				<span class='good'>Готово</span>
			{{/if}}
		</div>
    </div>
    <hr>
	<div class='item'>
		{{for data.job_slots}}
			 <div class='item'>
				<span class="average" style="font-weight: bold;">{{:value.title}}: {{:value.current_positions}}/{{:value.total_positions}}</span>
				{{:helper.link('-', null, {'action' : 'PRG_make_job_unavailable', 'job' : value.title}, value.can_close == 1 && data.authenticated ? null : 'disabled')}}
				{{:helper.link('+', null, {'action' : 'PRG_make_job_available', 'job' : value.title}, value.can_open == 1 && data.authenticated ? null : 'disabled')}}
				{{:helper.link('При', null, {'action' : 'PRG_prioritize_job', 'job' : value.title}, value.can_prioritize > 0 && data.authenticated ? null : 'disabled')}} {{if value.can_prioritize == 2}}<span class='warning'>Приоритетная должность</span> {{/if}}
			</div>
		{{/for}}
	</div>
	{{else data.mode == 2}}
		<div class='item'>
			<h2>Манифест экипажа</h2>
		</div>
		<div class='item'>
			{{:data.manifest}}
		</div>
	{{else data.mode == 3}}
		<div class='item'>
		    <h2>Записи</h2>
        </div>
        <div class='item'>
		    <div class='itemLabel'>
				Авторизованная личность:
		    </div>
		    <div class='itemContent'>
				{{:helper.link(data.scan_name, 'eject', {'action' : 'PRG_scan'})}}
		    </div>
		</div>
		<div class='item'>
		    {{if data.authenticated}}
				{{:data.id_change_html}}
				{{if data.centcom_access}}
					{{:helper.link('Удалить записи о: ' + data.scan_owner, null, {'action' : 'PRG_wipe_my_logs'}, null, 'linkDanger')}}
				{{/if}}
				{{if !data.target_dept}}
					{{:helper.link('Удалить ВСЕ записи', null, {'action' : 'PRG_wipe_all_logs'}, null, 'linkDanger')}}
				{{/if}}
		    {{else}}
				<span class='exclamation-triangle'><i>Пожалуйста, вставьте авторизированный ID в терминал для продолжения.</i></span><br>
		    {{/if}}
		</div>
	{{else}}
    <div class='item'>
      <h2>Модификация доступа</h2>
    </div>

    {{if !data.authenticated}}
      <span class='exclamation-triangle'><i>Пожалуйста, вставьте ID в терминал для продолжения.</i></span><br>
    {{/if}}

    <div class='item'>
      <div class='itemLabel'>
        Целевая личность:
      </div>
      <div class='itemContent'>
        {{:helper.link(data.target_name, 'eject', {'action' : 'PRG_modify'})}}
      </div>
    </div>
    <div class='item'>
      <div class='itemLabel'>
        Авторизованная личность:
      </div>
      <div class='itemContent'>
        {{:helper.link(data.scan_name, 'eject', {'action' : 'PRG_scan'})}}
      </div>
    </div>
    <hr>

    {{if data.authenticated}}
      <script type="text/javascript">
        function markRed(){
          var nameField = document.getElementById('namefield');
          nameField.style.backgroundColor = "#FFDDDD";
        }
        function markGreen(){
          var nameField = document.getElementById('namefield');
          nameField.style.backgroundColor = "#DDFFDD";
        }
        function markAccountGreen(){
          var nameField = document.getElementById('accountfield');
          nameField.style.backgroundColor = "#DDFFDD";
        }
        function markAccountRed(){
          var nameField = document.getElementById('accountfield');
          nameField.style.backgroundColor = "#FFDDDD";
        }
        function showAll(){
          var allJobsSlot = document.getElementById('allvalue.jobsslot');
          allJobsSlot.innerHTML = "<a href='#' onclick='hideAll()'>Спрятать</a><br>";
          var allJobs = document.getElementById('all-value.jobs');
          allJobs.style.display = 'block';
        }
        function hideAll(){
          var allJobsSlot = document.getElementById('allvalue.jobsslot');
          allJobsSlot.innerHTML = "<a href='#' onclick='showAll()'>{{:data.target_rank}}</a>";
          var allJobs = document.getElementById('all-value.jobs');
          allJobs.style.display = 'none';
        }
      </script>

      {{if data.has_modify}}
        <div class='item'>
          <h2>Детали</h2>
        </div>

        <form name='cardcomp' action='?src={{:data.src}}' method='get'>
          <div class='item'>
            <div class='itemLabel'>
              <input type='hidden' name='src' value='{{:data.src}}'>
              <input type='hidden' name='action' value='PRG_reg'>
              Зарегистрированное имя:
            </div>
            <div class='itemContent'>
              <input type='text' id='namefield' name='reg' value='{{:data.target_owner}}' onchange='markRed()'>
              <input type='submit' value='Переименовать' onclick='markGreen()'>
            </div>
          </div>
        </form>

        <form name='accountnum' action='?src={{:data.src}}' method='get'>
          <div class='item'>
            <div class='itemLabel'>
              <input type='hidden' name='src' value='{{:data.src}}'>
              <input type='hidden' name='action' value='PRG_account'>
              Номер аккаунта:
            </div>
            <div class='itemContent'>
              <input type='text' id='accountfield' name='account' value='{{:data.account_number}}' onchange='markAccountRed()'>
              <input type='submit' value='Модифицировать' onclick='markAccountGreen()'>
            </div>
          </div>
        </form>

        <div class='item'>
          <div class='itemLabel'>
            Уничтожение:
          </div>
          <div class='itemContent'>
			{{if data.target_rank == "Terminated"}}
				<span class='bad'>{{:data.target_owner}} уже уничтожен!</span>
			{{else}}
				{{:helper.link('Уничтожить ' + data.target_owner, 'gear', {'action' : 'PRG_terminate'}, data.target_rank == "Terminated" ? 'disabled' : null, data.target_rank == "Terminated" ? 'disabled' : 'linkDanger')}}
			{{/if}}
          </div>
        </div>

        <div class='item'>
          <h2>Назначения</h2>
        </div>

        <div class='item'>
          <span id='allvalue.jobsslot'>
            <a href='#' onclick='showAll()'>{{:data.target_rank}}</a>
          </span>
        </div>
        <div class='item'>
          <div id="all-value.jobs" style='display: none;'>
            <table>
              <tr>
                <th>Особые</th>
                <td>
					{{for data.top_jobs}}
						{{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
					{{/for}}
                </td>
              </tr>
              <tr>
                <th style="color: '#FFA500';">Инженерный</th>
                <td>
                  {{for data.engineering_jobs}}
                    {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                  {{/for}}
                </td>
              </tr>
              <tr>
                <th style="color: '#008000';">Медицинский</th>
                <td>
                  {{for data.medical_jobs}}
                    {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                  {{/for}}
                </td>
              </tr>
              <tr>
                <th style="color: '#DD0000';">Служба безопасности</th>
                <td>
                  {{for data.security_jobs}}
                    {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                  {{/for}}
                </td>
              </tr>
              <tr>
                <th style="color: '#C060C0';">Научный</th>
                <td>
                  {{for data.science_jobs}}
                    {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                  {{/for}}
                </td>
              </tr>
              <tr>
                <th style="color: '#A0A0A0';">Поддержка</th>
                <td>
                  {{for data.support_jobs}}
                    {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                  {{/for}}
                </td>
              </tr>
              <tr>
                <th style="color: '#808080';">Гражданские</th>
                <td>
                  {{for data.civilian_jobs}}
                    {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                  {{/for}}
                </td>
              </tr>
              {{if data.centcom_access}}
                <tr>
                  <th style="color: '#A52A2A';">ЦентКом</th>
                  <td>
                    {{for data.centcom_jobs}}
                      {{:helper.link(value.display_name, '', {'action' : 'PRG_assign', 'assign_target' : value.job}, value.jlinkformat == 'disabled' ? 'disabled' : null, value.jlinkformat ? value.jlinkformat : null)}}
                    {{/for}}
                  </td>
                </tr>
              {{/if}}
            </table>
          </div>
        </div>

        {{if data.centcom_access}}
          <div class='item'>
            <h2>Центральное Командование</h2>
          </div>
          <div class='item'>
            {{for data.all_centcom_access}}
              {{:helper.link(value.desc, '', {'action' : 'PRG_access', 'access_target' : value.ref, 'allowed' : value.allowed}, null, value.allowed ? 'selected' : null)}}
            {{/for}}
			<div class="item">
			<div class='average'><b>Скин карточки</b></div>
			{{for data.all_centcom_skins}}
				{{:helper.link(value.display_name, '', {'action' : 'PRG_skin', 'skin_target' : value.skin}, null,(data.current_skin == value.skin) ? 'selected' : null )}}
			{{/for}}
			</div>
          </div>
        {{else}}
          <div class='item'>
            <h2>{{:data.station_name}}</h2>
          </div>
          <div class='item'>
            {{for data.regions}}
              <div style='float: left; width: 175px; min-height: 250px'>
                <div class='average'><b>{{:value.name}}</b></div>
                {{for value.accesses :accessValue:accessKey}}
                  <div class='itemContentWide'>
                    {{:helper.link(accessValue.desc, '', {'action' : 'PRG_access', 'access_target' : accessValue.ref, 'allowed' : accessValue.allowed}, null, accessValue.allowed ? 'selected' : null)}}
                  </div>
                {{/for}}
              </div>
            {{/for}}
            <div style='float: left;'>
			<div class='average'><b>Скин карточки</b></div>
			  {{for data.card_skins}}
				{{:helper.link(value.display_name, '', {'action' : 'PRG_skin', 'skin_target' : value.skin}, null,(data.current_skin == value.skin) ? 'selected' : null )}}
			  {{/for}}
			</div>
          </div>
        {{/if}}
      {{/if}}
    {{/if}}
  {{/if}}
{{/if}}
